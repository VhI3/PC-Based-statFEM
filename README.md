# PC-Based-statFEM 

[![License: GPL v3](https://img.shields.io/badge/License-GPLv3-blue.svg)](LICENSE)

## ğŸ“„ Overview
`PC-Based-statFEM` The project implements a Gauss-Markov-KÃ¡lmÃ¡n Filter (GMKF)-based approach for the statFEM framework. Both the prior and posterior displacements are represented using Polynomial Chaos (PC) expansions, and the model-reality mismatch is modeled as a non-stationary random field through a Karhunen-LoÃ¨ve (KL) expansion.  

## ğŸ“š Related Publication
This codebase supports research from the following paper:  
> **Narouie, V., et al.** (2024). *Mechanical State Estimation with a Polynomial-Chaos-Based Statistical Finite Element Method*  
> Available on [arxiv.org/abs/2412.05037](https://arxiv.org/abs/2412.05037)

## ğŸ–¥ï¸ Installation
1. **Clone the repository:**
   ```bash
   git clone https://github.com/VhI3/PC-Based-statFEM.git
   cd PC-Based-statFEM
   ```

2. **Requirements:**
   - MATLAB R2020b or newer
   - Optimization Toolbox (for `fminunc`)
   - Statistics and Machine Learning Toolbox (for random number generation)

3. **Add library paths in MATLAB:**
   ```matlab
   addpath(genpath('lib'));
   ```

---

## ğŸ“ Usage
1. **Run the main script for 1D:**
   ```matlab
   ./src/tensionBar/main_tensionBar.m
   ```
2. **Run the main script for 2D:**
   ```matlab
   ./src/infinitePlate/main_infinitePlate.m
   ```
---

## ğŸ“Š Example Results
<p align="center">
  <img src="figures/fig1.png" width="300" alt="Displacement Distribution">
  <img src="figures/fig2.png" width="300" alt="Displacement Distribution">
  <img src="figures/fig3.png" width="300" alt="Displacement Distribution">
</p>

---

## ğŸ“‚ Repository Structure
```
PC-Based-statFEM/
â”œâ”€â”€ figures/                       # Output figures and visualizations generated by simulations
â”‚   â””â”€â”€ *.png                      # Plots 
â”‚
â”œâ”€â”€ lib/                           # Core numerical libraries and utility functions
â”‚   â”œâ”€â”€ fill_between.m             # Plotting utility to fill areas between curves
â”‚   â”œâ”€â”€ funcall.m                  # Helper function
â”‚   â”œâ”€â”€ gauss_hermite_rule.m       # Gaussian-Hermite quadrature rule implementation
â”‚   â”œâ”€â”€ Gauss_int.m                # Gaussian integration utilities
â”‚   â”œâ”€â”€ hermite.m                  # Hermite polynomial computations
â”‚   â”œâ”€â”€ Hermite_PC.m               # Hermite Polynomial Chaos expansion
â”‚   â”œâ”€â”€ Hermite_PC_d.m             # Hermite PC expansions for model-reality mismatch
â”‚   â”œâ”€â”€ Hermite_PC_e.m             # Hermite PC expansions for noise
â”‚   â”œâ”€â”€ H_projection.m             # Projection matrix 
â”‚   â”œâ”€â”€ inv2.m                     # Efficient inversion
â”‚   â”œâ”€â”€ Jacobian1D.m               # Jacobian calculations for 1D FEM elements
â”‚   â”œâ”€â”€ Jacobian2D.m               # Jacobian calculations for 2D FEM elements
â”‚   â”œâ”€â”€ KL_fredholm_Galerkin_local_1D.m     # 1D KL expansion solver using Fredholm integral equations
â”‚   â”œâ”€â”€ KL_fredholm_Galerkin_local_2D_optimized.m # Optimized 2D KL expansion solver
â”‚   â”œâ”€â”€ KL_Sensor_Galerkin_local_d.m       # KL expansions for model-reality 
â”‚   â”œâ”€â”€ Lagrange1D.m               # 1D Lagrange shape functions for FEM
â”‚   â”œâ”€â”€ Lagrange2D.m               # 2D Lagrange shape functions for FEM
â”‚   â”œâ”€â”€ Lagrange2D_d.m             # Derivatives of 2D Lagrange shape functions
â”‚   â”œâ”€â”€ lagrange_func.m            # Lagrange polynomial utility functions
â”‚   â”œâ”€â”€ lagrange_func_d.m          # Derivative computations for Lagrange polynomials
â”‚   â”œâ”€â”€ multi_index.m              # Multi-index generation for PC expansions
â”‚   â”œâ”€â”€ multiindex.m               # Alternative multi-index
â”‚   â”œâ”€â”€ smolyak_grid.m             # Smolyak sparse grid generation for high-dimensional integration
â”‚   â””â”€â”€ tensor_mesh.m              # Tensor product mesh generation utilities
â”‚
â”œâ”€â”€ src/                           # Source code for example simulations
â”‚   â”œâ”€â”€ infinitePlate/             # 2D plate with a hole simulation examples
â”‚   â”‚   â”œâ”€â”€ BVP_nsen11_nred11.mat  # Precomputed results with 11 sensors and 11 number or readings 
â”‚   â”‚   â”œâ”€â”€ BVP_nsen32_nred11.mat  # Precomputed results with 32 sensors and 11 number or readings
â”‚   â”‚   â”œâ”€â”€ BVP_nsen112_nred11.mat # Precomputed results with 112 sensors and 11 number or readings
â”‚   â”‚   â”œâ”€â”€ FEM_plateWithHole_Solver.m         # FEM solver for the plate with hole problem
â”‚   â”‚   â”œâ”€â”€ globalstiffness_hyper2.m          # Hyperelastic material stiffness matrix computation
â”‚   â”‚   â”œâ”€â”€ globalstiffness_linearElastic2D.m # Linear elastic material stiffness matrix computation
â”‚   â”‚   â”œâ”€â”€ main_infinitePlate.m              # Main driver script for the 2D plate simulation
â”‚   â”‚   â”œâ”€â”€ makeSurf.m                        # Surface plotting utility for displacement fields
â”‚   â”‚   â”œâ”€â”€ pk2cauchy.m                       # Conversion of PK2 stresses to Cauchy stresses
â”‚   â”‚   â”œâ”€â”€ plateWithHole_extended_PC.m      # PC expansion for extended analysis
â”‚   â”‚   â”œâ”€â”€ plateWithHole_FEM_preprocess.m   # Preprocessing for FEM inputs
â”‚   â”‚   â”œâ”€â”€ plateWithHole_FEM_processLE.m    # Linear elastic FEM solver
â”‚   â”‚   â”œâ”€â”€ plateWithHole_FEM_processLE_KL_Expansion.m # KL expansion integration for linear elasticity
â”‚   â”‚   â”œâ”€â”€ plateWithHole_FEM_processNH.m    # Hyperelastic FEM solver
â”‚   â”‚   â”œâ”€â”€ plateWithHole_FEM_surfplotV2.m   # Advanced surface plot generation
â”‚   â”‚   â”œâ”€â”€ plateWithHole_H_matrix.m         # H matrix computation
â”‚   â”‚   â”œâ”€â”€ plateWithHole_hyperParameter.m   # Hyperparameter definition for inference
â”‚   â”‚   â”œâ”€â”€ plate_with_hole_Mesh.m           # Mesh generation for the 2D plate domain
â”‚   â”‚   â”œâ”€â”€ plateWithHole_obs_generate.m     # Synthetic observation data generator
â”‚   â”‚   â”œâ”€â”€ plateWithHole_SSFEM_process_LE_PC_Expansion.m # Stochastic FEM with PC expansions
â”‚   â”‚   â”œâ”€â”€ plateWithHole_statFEM_modelReality_KL_Expansion.m # Model-reality mismatch via KL expansions
â”‚   â”‚   â”œâ”€â”€ plateWithHole_statFEM_Noise_PC_Expansion.m       # Noise modeling using PC expansions
â”‚   â”‚   â”œâ”€â”€ plateWithHole_statFEM_norm.m     # Norm calculation for displacement errors
â”‚   â”‚   â”œâ”€â”€ plateWithHole_statFEM_PC_update.m# Posterior update for PC coefficients
â”‚   â”‚   â”œâ”€â”€ quadsCheck.m                     # Quality check of quadrilateral mesh elements
â”‚   â”‚   â”œâ”€â”€ sensor_nsen11.m                  # Sensor layout for 11 sensors
â”‚   â”‚   â”œâ”€â”€ sensor_nsen32.m                  # Sensor layout for 32 sensors
â”‚   â”‚   â”œâ”€â”€ sensor_nsen112.m                 # Sensor layout for 112 sensors
â”‚   â”‚   â””â”€â”€ square_plate_with_hole2.geo      # Geometry file for Gmsh mesh generation
â”‚
â”‚   â””â”€â”€ tensionBar/              # 1D tension bar simulation examples
â”‚       â”œâ”€â”€ FEM_1DBar_Tipload_Solver.m      # FEM solver for the tension bar problem
â”‚       â”œâ”€â”€ main_tensionBar.m              # Main script to execute tension bar simulations
â”‚       â”œâ”€â”€ mean_yObs_ld10_1000.mat        # Observation data (l_d =  10)
â”‚       â”œâ”€â”€ mean_yObs_ld25_1000.mat        # Observation data (l_d  = 25)
â”‚       â”œâ”€â”€ mean_yObs_ld50_1000.mat        # Observation data (l_d = 50)
â”‚       â”œâ”€â”€ mean_yObs_ld100_1000.mat       # Observation data (l_d =  100)
â”‚       â”œâ”€â”€ tensionBar_extended_PC.m       # Extended PC expansions for tension bar analysis
â”‚       â”œâ”€â”€ tensionBar_FEM_preprocess.m    # Preprocessing for tension bar FEM analysis
â”‚       â”œâ”€â”€ tensionBar_FEM_preprocess_KL_Expansion.m # KL expansions for model error representation
â”‚       â”œâ”€â”€ tensionBar_FEM_process_LE.m    # Linear elastic FEM solver for the tension bar
â”‚       â”œâ”€â”€ tensionBar_H_matrix.m          # H matrix computation for posterior updates
â”‚       â”œâ”€â”€ tensionBar_hyperParameter.m    # Hyperparameter configuration
â”‚       â”œâ”€â”€ tensionBar_obs_generate.m      # Observation data generation scripts
â”‚       â”œâ”€â”€ tensionBar_plot.m              # Visualization utilities for tension bar results
â”‚       â”œâ”€â”€ tensionBar_RMSD_nr.m           # Root Mean Square Deviation analysis
â”‚       â”œâ”€â”€ tensionBar_RMSD_nr_v2.m        # Updated RMSD analysis with additional metrics
â”‚       â”œâ”€â”€ tensionBar_SSFEM_process_LE_PC_Expansion.m # Stochastic FEM with PC expansions
â”‚       â”œâ”€â”€ tensionBar_statFEM_modelReality_KL_Expansion_converge.m # KL-based convergence study
â”‚       â”œâ”€â”€ tensionBar_statFEM_PC_update.m # Posterior updates using PC coefficients
â”‚       â”œâ”€â”€ tensorBar_statFEM_Noise_PC_Expansion.m # Noise modeling in statFEM framework
â”‚       â””â”€â”€ yObs.mat                       # Synthetic observation data file
â”‚
â””â”€â”€ README.md                              # Project overview
```

---

## ğŸ›¡ï¸ License
This project is licensed under the [GNU General Public License v3.0 (GPL-3.0)](LICENSE).  
Feel free to use, modify, and distribute under the terms of the GPL.

---

## ğŸ™Œ Acknowledgments
- Developed at **TU-Braunschweig**.
- Special thanks to the research team and community contributors.
